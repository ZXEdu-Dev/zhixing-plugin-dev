var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,a)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,__spreadValues=(e,t)=>{for(var a in t||(t={}))__hasOwnProp.call(t,a)&&__defNormalProp(e,a,t[a]);if(__getOwnPropSymbols)for(var a of __getOwnPropSymbols(t))__propIsEnum.call(t,a)&&__defNormalProp(e,a,t[a]);return e},__spreadProps=(e,t)=>__defProps(e,__getOwnPropDescs(t));!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).ChoiceQuestion=t()}(this,(function(){"use strict";var e="_Question-Box_18tp1_1",t="_Question_18tp1_1",a="_Input-Box_18tp1_11",c="_Icon_18tp1_17",o="_Input_18tp1_11",s="_OptionList_18tp1_32",n="_Item_18tp1_32",r="_Selected_18tp1_46",l="_Action_18tp1_52",p="_Button_18tp1_61";return({options:i})=>{const{input:_,onExecuted:u,onChange:m,mode:d="display",api:{showRichText:f,showRichEditor:b}}=i,[R,h]=React.useState(""),[y,E]=React.useState(!1),[g,P]=React.useState([]),[w,O]=React.useState(),[k,N]=React.useState("edit"===d),x=React.useRef(),C=React.useCallback((e=>f(e)),[]),v=React.useCallback((e=>b(e)),[]);React.useEffect((()=>{if(!x.current)try{const e=JSON.parse(_);e.question&&h(e.question),e.multiple&&E(e.multiple),e.optionList&&P(e.optionList.map((e=>({text:e,selected:!1})))),x.current=!0}catch(e){console.log(e)}}),[_]),React.useEffect((()=>{if(!m)return;const e={question:R,multiple:y,optionList:g.map((e=>e.text))};m(JSON.stringify(e))}),[R,y,g]);const S=React.useMemo((()=>{const e=g.map(((e,t)=>__spreadProps(__spreadValues({},e),{index:t}))).filter(((e,t)=>e.selected)).map((e=>e.index)).sort();if(0!==e.length)return y?e.join():`${e[0]}`}),[y,g]),j=React.useCallback((()=>{O(S),u(S)}),[S]),I=React.useCallback((()=>{P((e=>e.concat([{}])))}),[]),B=React.useCallback((e=>{P((t=>(t.splice(e,1),Array.from(t))))}),[]),V=React.useCallback(((e,t)=>{P(y?e=>(e.forEach(((e,a)=>{a===t&&(e.selected=!e.selected)})),Array.from(e)):e=>(e.forEach(((e,a)=>{e.selected=a===t&&!e.selected})),Array.from(e)))}),[y]);return React.createElement("div",{className:e},React.createElement("div",{className:t},k?React.createElement(v,{className:o,options:{image:!0,heading:!0,codeBlock:!0,blockQuote:!0,subscript:!0},placeholder:"题目",defaultValue:R,onChange:e=>{h(e)}}):React.createElement(C,{html:R})),React.createElement("div",{className:s},g.map(((e,t)=>k?React.createElement("div",{key:t,className:a},React.createElement(v,{className:`${o} ${n}`,options:{image:!0,heading:!0,codeBlock:!0,blockQuote:!0,subscript:!0},placeholder:"题目",defaultValue:e.text,onChange:e=>{P((a=>{const c=Array.from(a);return c[t]=__spreadProps(__spreadValues({},c[t]),{text:e}),c}))}}),React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",onClick:()=>{B(t)},className:c,fill:"#ef4444"},React.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),React.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4 11H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1z"}))):React.createElement("div",{key:t,className:`${n} ${e.selected?r:""}`,onClick:()=>{V(e,t)}},React.createElement(C,{html:e.text}))))),React.createElement("div",{className:l},React.createElement("button",{disabled:!S||S===w,type:"button",onClick:j,className:p},"提交"),k&&React.createElement("button",{type:"button",onClick:I,className:p},"新增"),k&&React.createElement("button",{type:"button",onClick:()=>{E((e=>!e))},className:p},y?"多选":"单选"),"edit"===d&&React.createElement("button",{type:"button",onClick:()=>{N((e=>!e))},className:p},k?"普通模式":"编辑模式")))}}));
