var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(t,a,c)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:c}):t[a]=c,n=(e,t)=>{for(var a in t||(t={}))l.call(t,a)&&s(e,a,t[a]);if(c)for(var a of c(t))o.call(t,a)&&s(e,a,t[a]);return e},r=(e,c)=>t(e,a(c));var i="_Question-Box_19xez_1",u="_Question_19xez_1",m="_Input-Box_19xez_11",p="_Icon_19xez_16",d="_Input_19xez_11",R="_OptionList_19xez_32",_="_Item_19xez_32",f="_Selected_19xez_42",x="_Action_19xez_48",h="_Button_19xez_57";export default({options:e})=>{const{input:t,onExecuted:a,onChange:c,mode:l="display",api:o}=e,[s,b]=React.useState(),[y,E]=React.useState(!1),[v,g]=React.useState([]),[N,k]=React.useState(),[C,w]=React.useState("edit"===l),z=React.useRef(),O=React.useMemo((()=>o.showRichEditor),[]);React.useEffect((()=>{if(!z.current)try{const e=JSON.parse(t);e.question&&b(e.question),e.multiple&&E(e.multiple),e.optionList&&g(e.optionList.map((e=>({text:e,selected:!1})))),z.current=!0}catch(e){console.log(e)}}),[t]),React.useEffect((()=>{if(!c)return;const e={question:s,multiple:y,optionList:v.map((e=>e.text))};c(JSON.stringify(e))}),[s,y,v]);const S=React.useMemo((()=>{const e=v.map(((e,t)=>r(n({},e),{index:t}))).filter(((e,t)=>e.selected)).map((e=>e.index)).sort();if(0!==e.length)return y?e.join():`${e[0]}`}),[y,v]),j=React.useCallback((()=>{k(S),a(S)}),[S]),A=React.useCallback((()=>{g((e=>e.concat([{}])))}),[]),B=React.useCallback((e=>{g((t=>(t.splice(e,1),Array.from(t))))}),[]),I=React.useCallback(((e,t)=>{g(y?e=>(e.forEach(((e,a)=>{a===t&&(e.selected=!e.selected)})),Array.from(e)):e=>(e.forEach(((e,a)=>{e.selected=a===t&&!e.selected})),Array.from(e)))}),[y]);return React.createElement("div",{className:i},React.createElement("div",{className:u},C?O({className:d,options:{image:!0,heading:!0,codeBlock:!0,blockQuote:!0,subscript:!0},placeholder:"问题",defaultValue:s,onChange:e=>{b(e)}}):showRichText({html:s})),React.createElement("div",{className:R},v.map(((e,t)=>C?React.createElement("div",{key:t,className:m},React.createElement("textarea",{placeholder:"选项",className:`${d} ${_}`,value:e.text,onChange:e=>{g((a=>{const c=Array.from(a);return c[t]=r(n({},c[t]),{text:e.target.value}),c}))}}),React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",onClick:()=>{B(t)},className:p,fill:"#ef4444"},React.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),React.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4 11H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1z"}))):React.createElement("div",{key:t,className:`${_} ${e.selected?f:""}`,onClick:()=>{I(e,t)}},showRichText({html:e.text}))))),React.createElement("div",{className:x},React.createElement("button",{disabled:!S||S===N,type:"button",onClick:j,className:h},"提交"),C&&React.createElement("button",{type:"button",onClick:A,className:h},"新增"),C&&React.createElement("button",{type:"button",onClick:()=>{E((e=>!e))},className:h},y?"多选":"单选"),"edit"===l&&React.createElement("button",{type:"button",onClick:()=>{w((e=>!e))},className:h},C?"普通模式":"编辑模式")))};
