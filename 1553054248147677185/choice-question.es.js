var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,s=(t,a,c)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:c}):t[a]=c,n=(e,t)=>{for(var a in t||(t={}))o.call(t,a)&&s(e,a,t[a]);if(c)for(var a of c(t))l.call(t,a)&&s(e,a,t[a]);return e},r=(e,c)=>t(e,a(c));var i="_Question-Box_19xez_1",u="_Question_19xez_1",m="_Input-Box_19xez_11",p="_Icon_19xez_16",d="_Input_19xez_11",R="_OptionList_19xez_32",_="_Item_19xez_32",h="_Selected_19xez_42",f="_Action_19xez_48",x="_Button_19xez_57";export default({options:e})=>{const{input:t,onExecuted:a,onChange:c,mode:o="display",api:l}=e,[s,b]=React.useState(),[E,y]=React.useState(!1),[g,v]=React.useState([]),[N,k]=React.useState(),[w,C]=React.useState("edit"===o),z=React.useRef(),O=React.useMemo((()=>(console.log("showRichEditor"),l.showRichEditor)),[]);React.useEffect((()=>{if(!z.current){console.log("inited");try{const e=JSON.parse(t);e.question&&b(e.question),e.multiple&&y(e.multiple),e.optionList&&v(e.optionList.map((e=>({text:e,selected:!1})))),z.current=!0}catch(e){console.log(e)}}}),[t]),React.useEffect((()=>{if(!c)return;const e={question:s,multiple:E,optionList:g.map((e=>e.text))};c(JSON.stringify(e))}),[s,E,g]);const S=React.useMemo((()=>{const e=g.map(((e,t)=>r(n({},e),{index:t}))).filter(((e,t)=>e.selected)).map((e=>e.index)).sort();if(0!==e.length)return E?e.join():`${e[0]}`}),[E,g]),j=React.useCallback((()=>{k(S),a(S)}),[S]),A=React.useCallback((()=>{v((e=>e.concat([{}])))}),[]),B=React.useCallback((e=>{v((t=>(t.splice(e,1),Array.from(t))))}),[]),I=React.useCallback(((e,t)=>{v(E?e=>(e.forEach(((e,a)=>{a===t&&(e.selected=!e.selected)})),Array.from(e)):e=>(e.forEach(((e,a)=>{e.selected=a===t&&!e.selected})),Array.from(e)))}),[E]);return React.createElement("div",{className:i},React.createElement("div",{className:u},w?O({className:d,options:{image:!0,heading:!0,codeBlock:!0,blockQuote:!0,subscript:!0},placeholder:"问题",defaultValue:s,onChange:e=>{b(e)}}):showRichText({html:s})),React.createElement("div",{className:R},g.map(((e,t)=>w?React.createElement("div",{key:t,className:m},React.createElement("textarea",{placeholder:"选项",className:`${d} ${_}`,value:e.text,onChange:e=>{v((a=>{const c=Array.from(a);return c[t]=r(n({},c[t]),{text:e.target.value}),c}))}}),React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",onClick:()=>{B(t)},className:p,fill:"#ef4444"},React.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),React.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4 11H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1z"}))):React.createElement("div",{key:t,className:`${_} ${e.selected?h:""}`,onClick:()=>{I(e,t)}},showRichText({html:e.text}))))),React.createElement("div",{className:f},React.createElement("button",{disabled:!S||S===N,type:"button",onClick:j,className:x},"提交"),w&&React.createElement("button",{type:"button",onClick:A,className:x},"新增"),w&&React.createElement("button",{type:"button",onClick:()=>{y((e=>!e))},className:x},E?"多选":"单选"),"edit"===o&&React.createElement("button",{type:"button",onClick:()=>{C((e=>!e))},className:x},w?"普通模式":"编辑模式")))};
